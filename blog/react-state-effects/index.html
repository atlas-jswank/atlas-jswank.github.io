<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="/favicon.png"><meta name="generator" content="Astro v4.11.5"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://example.com/blog/react-state-effects/"><!-- Primary Meta Tags --><title>React State: useEffect | in{struct} blog </title><meta name="title" content="React State: useEffect | in{struct} blog "><meta name="description" content="Lorem ipsum dolor sit amet"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://example.com/blog/react-state-effects/"><meta property="og:title" content="React State: useEffect | in{struct} blog "><meta property="og:description" content="Lorem ipsum dolor sit amet"><meta property="og:image" content="https://example.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://example.com/blog/react-state-effects/"><meta property="twitter:title" content="React State: useEffect | in{struct} blog "><meta property="twitter:description" content="Lorem ipsum dolor sit amet"><meta property="twitter:image" content="https://example.com/blog-placeholder-1.jpg"><link rel="stylesheet" href="/assets/about.DtBl5kP2.css">
<style>.author[data-astro-cid-bvzihdzo]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding-top:48px;color:var(--blue-light)}.author[data-astro-cid-bvzihdzo] span[data-astro-cid-bvzihdzo]{line-height:1.3}.author-image[data-astro-cid-bvzihdzo]{border-radius:50px}main[data-astro-cid-bvzihdzo]{width:100%;max-width:100%;margin:0;padding:0}.hero-image[data-astro-cid-bvzihdzo]{width:100%;margin-top:3rem}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose-wrapper[data-astro-cid-bvzihdzo]{color:var(--blue);background-color:var(--off-white-light);margin-top:3rem;border-top-left-radius:30px;border-top-right-radius:30px}.prose[data-astro-cid-bvzihdzo]{width:1020px;max-width:calc(100% - 2em);margin:auto;padding:1em}.title[data-astro-cid-bvzihdzo]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5em}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}hr[data-astro-cid-bvzihdzo]{border-top:1px solid var(--blue)}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2> <img src="/logo.png" alt="Logo" class="logo" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>in{struct} blog</a> </h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <!-- <HeaderLink href="/">Home</HeaderLink> --> <!-- <HeaderLink href="/about">About</HeaderLink> --> </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://github.com/atlas-jswank" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Jeremiah Swanks's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://www.linkedin.com/in/jeremiah-swank-0a3559264/" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Jeremiah Swanks's LinkedIn</span> <svg style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" viewBox="0 0 512 512" width="32" height="32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" data-astro-cid-3ef6ksr2></path></svg> </a> </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo> <img width="1020" height="510" src="/react-state-3.webp" alt="" data-astro-cid-bvzihdzo> </div> <div class="prose-wrapper" data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="author" data-astro-cid-bvzihdzo> <img width="70" height="70" src="/jswank.jpg" alt="author" class="author-image" data-astro-cid-bvzihdzo> <span data-astro-cid-bvzihdzo>Jeremiah Swank</span> <span data-astro-cid-bvzihdzo><time datetime="2024-08-24T05:00:00.000Z"> Aug 24, 2024 </time></span> </div> <div class="title" data-astro-cid-bvzihdzo> <h1 data-astro-cid-bvzihdzo>React State: useEffect</h1> </div>  <p>In React its common to need to perform actions or “effects” at certain points in the component lifecycle. For example you may want to call an API whenever the component loads for the first time (mounts) or clear data from local storage whenever the component is removed (unmounts).</p>
<h3 id="the-useeffect-hook">The useEffect Hook</h3>
<p>The <code>useEffect</code> hook in React is a powerful tool for managing side effects in functional components. It allows developers to perform actions such as data fetching independent from the rendering of the component.</p>
<p>The <code>useEffect</code> hook takes a function as its first argument, which is executed after the component renders.</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">function</span><span style="color:#1ED2AF"> FooBar</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#1ED2AF">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> { </span></span>
<span class="line"><span style="color:#6A737D">    //Called after the component renders for the first time</span></span>
<span class="line"><span style="color:#E1E4E8">    console.</span><span style="color:#1ED2AF">log</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"Component mounted"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    localStorage.</span><span style="color:#1ED2AF">setItem</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"load-time"</span><span style="color:#E1E4E8">, </span><span style="color:#D00414">new</span><span style="color:#1ED2AF"> Date</span><span style="color:#E1E4E8">().</span><span style="color:#1ED2AF">toLocaleString</span><span style="color:#E1E4E8">());</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">h1</span><span style="color:#E1E4E8">>Hello useEffect&#x3C;/</span><span style="color:#1ED2AF">h1</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>Optionally, you can return a funtion from the effect hook that will be called whenever the component is unmounted:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">function</span><span style="color:#1ED2AF"> FooBar</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#1ED2AF">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    //Called after the component renders for the first time</span></span>
<span class="line"><span style="color:#E1E4E8">    console.</span><span style="color:#1ED2AF">log</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"Component mounted"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    localStorage.</span><span style="color:#1ED2AF">setItem</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"load-time"</span><span style="color:#E1E4E8">, </span><span style="color:#D00414">new</span><span style="color:#1ED2AF"> Date</span><span style="color:#E1E4E8">().</span><span style="color:#1ED2AF">toLocaleString</span><span style="color:#E1E4E8">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">    return</span><span style="color:#E1E4E8"> () </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">      // Called when the component is removed from the page</span></span>
<span class="line"><span style="color:#E1E4E8">      console.</span><span style="color:#1ED2AF">log</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"Component unmounted"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">      localStorage.</span><span style="color:#1ED2AF">removeItem</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"load-time"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">h1</span><span style="color:#E1E4E8">>Hello useEffect&#x3C;/</span><span style="color:#1ED2AF">h1</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>This make it handy to perform cleanup tasks when the component is removed from the page.</p>
<p>Another common use case for <code>useEffect</code> is to perform an action whenever a state variable changes. The <code>useEffect</code> hook optionally takes an array of dependencies as its second argument. The effect function runs whenever the dependencies change, providing a way to synchronize the component’s state with external systems. For example:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">function</span><span style="color:#1ED2AF"> FooBar</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D00414">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#1ED2AF">foo</span><span style="color:#E1E4E8">, </span><span style="color:#1ED2AF">setFoo</span><span style="color:#E1E4E8">] </span><span style="color:#D00414">=</span><span style="color:#1ED2AF"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#1ED2AF">0</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D00414">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#1ED2AF">bar</span><span style="color:#E1E4E8">, </span><span style="color:#1ED2AF">setBar</span><span style="color:#E1E4E8">] </span><span style="color:#D00414">=</span><span style="color:#1ED2AF"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#1ED2AF">0</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D00414">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#1ED2AF">baz</span><span style="color:#E1E4E8">, </span><span style="color:#1ED2AF">setBaz</span><span style="color:#E1E4E8">] </span><span style="color:#D00414">=</span><span style="color:#1ED2AF"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#1ED2AF">0</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1ED2AF">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    //Called when foo and bar change but not baz</span></span>
<span class="line"><span style="color:#E1E4E8">    localStorage.</span><span style="color:#1ED2AF">setItem</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"foo"</span><span style="color:#E1E4E8">, foo);</span></span>
<span class="line"><span style="color:#E1E4E8">    localStorage.</span><span style="color:#1ED2AF">setItem</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"bar"</span><span style="color:#E1E4E8">, bar);</span></span>
<span class="line"><span style="color:#E1E4E8">  }, [foo, bar]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">button</span><span style="color:#1ED2AF"> onClick</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{() </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setFoo</span><span style="color:#E1E4E8">(foo </span><span style="color:#D00414">+</span><span style="color:#1ED2AF"> 1</span><span style="color:#E1E4E8">)}> Increment Foo&#x3C;/</span><span style="color:#1ED2AF">button</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">button</span><span style="color:#1ED2AF"> onClick</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{() </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setBar</span><span style="color:#E1E4E8">(bar </span><span style="color:#D00414">+</span><span style="color:#1ED2AF"> 1</span><span style="color:#E1E4E8">)}> Increment Bar&#x3C;/</span><span style="color:#1ED2AF">button</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">button</span><span style="color:#1ED2AF"> onClick</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{() </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setBaz</span><span style="color:#E1E4E8">(baz </span><span style="color:#D00414">+</span><span style="color:#1ED2AF"> 1</span><span style="color:#E1E4E8">)}> Increment Baz&#x3C;/</span><span style="color:#1ED2AF">button</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>This <code>useEffect</code> will store the values of foo and bar in local storage whenever they change but nothing happens when baz changes.</p>
<h3 id="fetching-data">Fetching Data</h3>
<p>Lets explore a common use case for <code>useEffect</code> in React: fetching data from an API. Here we will integrate will an API for fetching pictures of Dogs. Here is the starter code:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">import</span><span style="color:#E1E4E8"> { useEffect } </span><span style="color:#D00414">from</span><span style="color:#F7F0DC"> "react"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">function</span><span style="color:#1ED2AF"> Dogs</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#1ED2AF">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    //Call API</span></span>
<span class="line"><span style="color:#E1E4E8">  }, []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">img</span><span style="color:#1ED2AF"> src</span><span style="color:#D00414">=</span><span style="color:#F7F0DC">"https://images.dog.ceo/breeds/bulldog-french/n02108915_12319.jpg"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>We will use the fetch function to call the API. From there we need to store the data returned from the API in a state variable:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">function</span><span style="color:#1ED2AF"> Dogs</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D00414">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#1ED2AF">dogs</span><span style="color:#E1E4E8">, </span><span style="color:#1ED2AF">setDogs</span><span style="color:#E1E4E8">] </span><span style="color:#D00414">=</span><span style="color:#1ED2AF"> useState</span><span style="color:#E1E4E8">([]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1ED2AF">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#1ED2AF">    fetch</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"https://dog.ceo/api/breed/bulldog/french/images/random/3"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">response</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> response.</span><span style="color:#1ED2AF">json</span><span style="color:#E1E4E8">())</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">data</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setDogs</span><span style="color:#E1E4E8">(data.message));</span></span>
<span class="line"><span style="color:#E1E4E8">  }, []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">img</span><span style="color:#1ED2AF"> src</span><span style="color:#D00414">=</span><span style="color:#F7F0DC">"https://images.dog.ceo/breeds/bulldog-french/n02108915_12319.jpg"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>Let brake down this code:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">const</span><span style="color:#E1E4E8"> [</span><span style="color:#1ED2AF">dogs</span><span style="color:#E1E4E8">, </span><span style="color:#1ED2AF">setDogs</span><span style="color:#E1E4E8">] </span><span style="color:#D00414">=</span><span style="color:#1ED2AF"> useState</span><span style="color:#E1E4E8">([]);</span></span>
<span class="line"></span></code></pre>
<p>This is the state variable we will store the array of dog images in that is returned from the API. <code>setDogs</code> will be used to update the value after the API returns data. <code>dogs</code> is used to read the list of dog images.</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#1ED2AF">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#1ED2AF">    fetch</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">"https://dog.ceo/api/breed/bulldog/french/images/random/5"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">response</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> response.</span><span style="color:#1ED2AF">json</span><span style="color:#E1E4E8">())</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">data</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setDogs</span><span style="color:#E1E4E8">(data.message));</span></span>
<span class="line"><span style="color:#E1E4E8">  }, []);</span></span>
<span class="line"></span></code></pre>
<p>This <code>useEffect</code> hook calls the dog API to get a list of random images. It is called AFTER the first render. fetch happens asynchronously so we need to use the <code>then</code> method to read the response that is returned and update our state variable. The <code>[]</code> as the second argument to useEffect tells it to run only whenever the component first renders.</p>
<p>Now that we have an array of images we can update our return statement to display the images:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414"> return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      {dogs.</span><span style="color:#1ED2AF">map</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">url</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;</span><span style="color:#1ED2AF">img</span><span style="color:#1ED2AF"> key</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{url} </span><span style="color:#1ED2AF">src</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{url} /></span></span>
<span class="line"><span style="color:#E1E4E8">      ))}</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"></span></code></pre>
<p>Now whenever the component renders a list of random images will display on the page. Let take this a step further and add a button that will increase the number of dogs displayed on the page. Lets create a state variable to track the number of images to fetch:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">function</span><span style="color:#1ED2AF"> Dogs</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D00414">  ...</span></span>
<span class="line"><span style="color:#D00414">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#1ED2AF">count</span><span style="color:#E1E4E8">, </span><span style="color:#1ED2AF">setCount</span><span style="color:#E1E4E8">] </span><span style="color:#D00414">=</span><span style="color:#1ED2AF"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#1ED2AF">1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D00414">  ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">button</span><span style="color:#1ED2AF"> onClick</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{() </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setCount</span><span style="color:#E1E4E8">(count </span><span style="color:#D00414">+</span><span style="color:#1ED2AF"> 1</span><span style="color:#E1E4E8">)}>More dogs!&#x3C;/</span><span style="color:#1ED2AF">button</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      {dogs.</span><span style="color:#1ED2AF">map</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">url</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;</span><span style="color:#1ED2AF">img</span><span style="color:#1ED2AF"> key</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{url} </span><span style="color:#1ED2AF">src</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{url} /></span></span>
<span class="line"><span style="color:#E1E4E8">      ))}</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>From here we can modify the <code>useEffect</code> hook to fetch more dogs when the value of <code>count</code> changes:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#1ED2AF"> useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#1ED2AF">    fetch</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">`https://dog.ceo/api/breed/bulldog/french/images/random/${</span><span style="color:#E1E4E8">count</span><span style="color:#F7F0DC">}`</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">response</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> response.</span><span style="color:#1ED2AF">json</span><span style="color:#E1E4E8">())</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">data</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setDogs</span><span style="color:#E1E4E8">(data.message));</span></span>
<span class="line"><span style="color:#E1E4E8">  }, [count]); </span><span style="color:#6A737D">// run effect everytime count changes</span></span>
<span class="line"></span></code></pre>
<p>There are two imporant change here. The count variable is added to the API request in the fetch function. We also added the <code>count</code> variable to the dependency array. This is necessary to rerun the effect hook whenever count changes. Without this the effect only runs once when the component first mounts.</p>
<p>You’ll notice there is a flicker before the images are displayed. This is because the effect hook doesn’t run until after the first render. We can add a loading state to show the user that the images are loading. Lets crate a new state variable to track the loading state:</p>
<pre class="astro-code github-dark" style="background-color:#00003c;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsx"><code><span class="line"><span style="color:#D00414">function</span><span style="color:#1ED2AF"> Dogs</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D00414">  ...</span></span>
<span class="line"><span style="color:#D00414">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#1ED2AF">loading</span><span style="color:#E1E4E8">, </span><span style="color:#1ED2AF">setLoading</span><span style="color:#E1E4E8">] </span><span style="color:#D00414">=</span><span style="color:#1ED2AF"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#1ED2AF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1ED2AF">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#1ED2AF">    setLoading</span><span style="color:#E1E4E8">(</span><span style="color:#1ED2AF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#1ED2AF">    fetch</span><span style="color:#E1E4E8">(</span><span style="color:#F7F0DC">`https://dog.ceo/api/breed/bulldog/french/images/random/${</span><span style="color:#E1E4E8">count</span><span style="color:#F7F0DC">}`</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">response</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> response.</span><span style="color:#1ED2AF">json</span><span style="color:#E1E4E8">())</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">then</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">data</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setDogs</span><span style="color:#E1E4E8">(data.message))</span></span>
<span class="line"><span style="color:#E1E4E8">      .</span><span style="color:#1ED2AF">finally</span><span style="color:#E1E4E8">(() </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setLoading</span><span style="color:#E1E4E8">(</span><span style="color:#1ED2AF">false</span><span style="color:#E1E4E8">));</span></span>
<span class="line"><span style="color:#E1E4E8">  }, [count]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  if</span><span style="color:#E1E4E8"> (loading) {</span></span>
<span class="line"><span style="color:#D00414">    return</span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#1ED2AF">p</span><span style="color:#E1E4E8">>Loading....&#x3C;/</span><span style="color:#1ED2AF">p</span><span style="color:#E1E4E8">>;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D00414">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#1ED2AF">button</span><span style="color:#1ED2AF"> onClick</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{() </span><span style="color:#D00414">=></span><span style="color:#1ED2AF"> setCount</span><span style="color:#E1E4E8">(count </span><span style="color:#D00414">+</span><span style="color:#1ED2AF"> 1</span><span style="color:#E1E4E8">)}>More dogs!&#x3C;/</span><span style="color:#1ED2AF">button</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      {dogs.</span><span style="color:#1ED2AF">map</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">url</span><span style="color:#E1E4E8">) </span><span style="color:#D00414">=></span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;</span><span style="color:#1ED2AF">img</span><span style="color:#1ED2AF"> key</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{url} </span><span style="color:#1ED2AF">src</span><span style="color:#D00414">=</span><span style="color:#E1E4E8">{url} /></span></span>
<span class="line"><span style="color:#E1E4E8">      ))}</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>Here we set the loading to true at the start of the effect hook and set loading to false after the data is fetched. We conditionally render a loading message when loading is true. This gives a better user experience when loading data from the API is running slow.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Using the <code>useEffect</code> hook to fetch data from an API is a highly effective way to integrate asynchronous operations into functional components in React. By leveraging <code>useEffect</code>, developers can initiate data fetching operations when a component mounts or when specific dependencies change, ensuring that data is loaded and displayed appropriately. This approach simplifies the management of side effects and allows for clear, maintainable code that reacts to changes in data or state.</p>
<p>Additionally, useEffect facilitates proper handling of cleanup tasks, such as aborting ongoing requests, to prevent potential memory leaks. Overall, <code>useEffect </code>streamlines the process of fetching and managing data, enhancing the responsiveness and reliability of React applications.</p>  </div> </div> </article> <footer data-astro-cid-sz7xmlte>
&copy; 2024 Jeremiah Swank. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://github.com/atlas-jswank" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Jeremiah Swank's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://www.linkedin.com/in/jeremiah-swank-0a3559264/" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Jeremiah Swanks's LinkedIn</span> <svg style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" viewBox="0 0 512 512" width="32" height="32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" data-astro-cid-sz7xmlte><path fill="currentColor" d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  </main> </body></html>